<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qoo10å¤šåŠŸèƒ½æ•°æ®å·¥å…· - ç½‘é¡µç‰ˆ</title>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #4CAF50;
            --warning-color: #FF9800;
            --info-color: #2196F3;
            --danger-color: #f44336;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo h1 {
            color: var(--primary-color);
            font-size: 24px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .main-content {
            display: flex;
            min-height: 600px;
        }
        
        .sidebar {
            width: 250px;
            background: #f8f9fa;
            padding: 20px;
            border-right: 1px solid #eee;
        }
        
        .content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .login-container {
            width: 100%;
            max-width: 400px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        button {
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #449d44;
        }
        
        .btn-warning {
            background: var(--warning-color);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e68900;
        }
        
        .btn-info {
            background: var(--info-color);
            color: white;
        }
        
        .btn-info:hover {
            background: #1a7dc4;
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-header {
            padding-bottom: 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }
        
        .nav-menu {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 10px;
        }
        
        .nav-link {
            display: block;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            color: #555;
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .nav-link:hover, .nav-link.active {
            background: var(--primary-color);
            color: white;
        }
        
        .hidden {
            display: none;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th, .table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .status-success {
            background: #e8f5e8;
            color: var(--success-color);
        }
        
        .status-warning {
            background: #fff3e0;
            color: var(--warning-color);
        }
        
        .status-danger {
            background: #ffeaea;
            color: var(--danger-color);
        }
        
        .progress-bar {
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--success-color);
            transition: width 0.3s;
        }
        
        .alert {
            padding: 12px 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #e8f5e8;
            color: var(--success-color);
            border: 1px solid #c3e6cb;
        }
        
        .alert-error {
            background: #ffeaea;
            color: var(--danger-color);
            border: 1px solid #f5c6cb;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        
        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .tool-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
            cursor: pointer;
        }
        
        .tool-card:hover {
            transform: translateY(-5px);
        }
        
        .tool-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .tool-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .tool-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #eee;
            }
            
            .tool-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div id="loginPage" class="login-container">
        <div class="logo" style="justify-content: center; margin-bottom: 30px;">
            <h1>ğŸ”§ Qoo10æ•°æ®å·¥å…·</h1>
        </div>
        
        <div id="loginAlert" class="alert alert-error hidden"></div>
        
        <form id="loginForm">
            <div class="form-group">
                <label for="username">ç”¨æˆ·å</label>
                <input type="text" id="username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" required>
            </div>
            
            <div class="form-group">
                <label for="password">å¯†ç </label>
                <input type="password" id="password" placeholder="è¯·è¾“å…¥å¯†ç " required>
            </div>
            
            <button type="submit" class="btn-primary" style="width: 100%;">ç™»å½•</button>
        </form>
        
        <div style="margin-top: 20px; text-align: center; font-size: 14px; color: #666;">
            <p>ç®¡ç†å‘˜è´¦å·: admin / å¯†ç : 112211</p>
            <p style="margin-top: 10px;">æ¼”ç¤ºè´¦å·: demo / å¯†ç : 123456</p>
        </div>
    </div>
    
    <!-- ä¸»åº”ç”¨é¡µé¢ -->
    <div id="appPage" class="container hidden">
        <div class="header">
            <div class="logo">
                <h1>ğŸ”§ Qoo10æ•°æ®å·¥å…·</h1>
            </div>
            
            <div class="user-info">
                <span id="userRole"></span>
                <button id="logoutBtn" class="btn-danger">é€€å‡ºç™»å½•</button>
            </div>
        </div>
        
        <div class="main-content">
            <div class="sidebar">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-tab="dashboard">æ§åˆ¶é¢æ¿</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="collector">å…³é”®è¯é‡‡é›†</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="brandDetector">å“ç‰Œæ£€æµ‹</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-tab="urlDetector">URLæ£€æµ‹</a>
                    </li>
                    <li id="adminNav" class="nav-item hidden">
                        <a href="#" class="nav-link" data-tab="userManagement">ç”¨æˆ·ç®¡ç†</a>
                    </li>
                    <li id="adminNav2" class="nav-item hidden">
                        <a href="#" class="nav-link" data-tab="settings">ç³»ç»Ÿè®¾ç½®</a>
                    </li>
                </ul>
            </div>
            
            <div class="content">
                <!-- æ§åˆ¶é¢æ¿ -->
                <div id="dashboard" class="tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">æ¬¢è¿ä½¿ç”¨ Qoo10æ•°æ®å·¥å…·</h2>
                        </div>
                        <p>è¿™æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„æ•°æ®é‡‡é›†å’Œåˆ†æå·¥å…·ï¼Œä¸“ä¸ºQoo10å¹³å°è®¾è®¡ã€‚</p>
                        
                        <div class="tool-grid">
                            <div class="tool-card" data-tab="collector">
                                <div class="tool-icon">ğŸ“¥</div>
                                <div class="tool-title">å…³é”®è¯é‡‡é›†</div>
                                <div class="tool-desc">æ‰¹é‡é‡‡é›†å•†å“é“¾æ¥ï¼Œè‡ªåŠ¨æ»šåŠ¨é¡µé¢è·å–æ›´å¤šç»“æœ</div>
                            </div>
                            
                            <div class="tool-card" data-tab="brandDetector">
                                <div class="tool-icon">ğŸ”</div>
                                <div class="tool-title">å“ç‰Œæ£€æµ‹</div>
                                <div class="tool-desc">æ£€æµ‹æœç´¢ç»“æœä¸­æ˜¯å¦åŒ…å«å“ç‰Œå•†å“</div>
                            </div>
                            
                            <div class="tool-card" data-tab="urlDetector">
                                <div class="tool-icon">ğŸŒ</div>
                                <div class="tool-title">URLæ£€æµ‹</div>
                                <div class="tool-desc">åˆ†æå•†å“é¡µé¢æ•°æ®ï¼Œæå–ä»·æ ¼ã€é”€å”®ç­‰ä¿¡æ¯</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">ä½¿ç”¨ç»Ÿè®¡</h2>
                        </div>
                        <div id="usageStats">
                            <p>æ‚¨çš„è´¦å·æœ‰æ•ˆæœŸè‡³: <span id="expiryDate">2023-12-31</span></p>
                            <p>å‰©ä½™å¤©æ•°: <span id="remainingDays">30</span> å¤©</p>
                        </div>
                    </div>
                </div>
                
                <!-- å…³é”®è¯é‡‡é›† -->
                <div id="collector" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">å…³é”®è¯é‡‡é›†</h2>
                        </div>
                        
                        <div class="form-group">
                            <label for="collectorKeywords">è¾“å…¥å…³é”®è¯ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰:</label>
                            <textarea id="collectorKeywords" rows="5" placeholder="è¯·è¾“å…¥æœç´¢å…³é”®è¯ï¼Œæ¯è¡Œä¸€ä¸ª&#10;ä¾‹å¦‚ï¼š&#10;ã‚ã‚“ã´ãƒ¼ã™&#10;çŒ«ç”¨ãŠã‚‚ã¡ã‚ƒ&#10;ãƒ‰ãƒƒã‚°ãƒ•ãƒ¼ãƒ‰"></textarea>
                        </div>
                        
                        <div class="button-group" style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <button id="startCollect" class="btn-primary">å¼€å§‹æ‰¹é‡é‡‡é›†</button>
                            <button id="stopCollect" class="btn-warning" disabled>åœæ­¢é‡‡é›†</button>
                        </div>
                        
                        <div class="progress">
                            <div>è¿›åº¦: <span id="progressText">0/0</span></div>
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="button-group" style="display: flex; gap: 10px; margin-top: 20px;">
                            <button id="exportCSV" class="btn-info" disabled>å¯¼å‡ºCSV</button>
                            <button id="viewResults" class="btn-secondary">æŸ¥çœ‹é‡‡é›†ç»“æœ</button>
                        </div>
                        
                        <div id="collectorStatus" class="status" style="margin-top: 20px;">å°±ç»ª - è¯·è¾“å…¥å…³é”®è¯åå¼€å§‹é‡‡é›†</div>
                    </div>
                </div>
                
                <!-- å“ç‰Œæ£€æµ‹ -->
                <div id="brandDetector" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">å“ç‰Œæ£€æµ‹</h2>
                        </div>
                        
                        <div class="form-group">
                            <label for="brandKeywords">è¾“å…¥å…³é”®è¯ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰:</label>
                            <textarea id="brandKeywords" rows="5" placeholder="è¯·è¾“å…¥æœç´¢å…³é”®è¯ï¼Œæ¯è¡Œä¸€ä¸ª&#10;ä¾‹å¦‚ï¼š&#10;ã‚ã‚“ã´ãƒ¼ã™&#10;çŒ«ç”¨ãŠã‚‚ã¡ã‚ƒ&#10;ãƒ‰ãƒƒã‚°ãƒ•ãƒ¼ãƒ‰"></textarea>
                        </div>
                        
                        <div class="button-group" style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <button id="checkBrand" class="btn-primary">å¼€å§‹å“ç‰Œæ£€æµ‹</button>
                            <button id="viewBrandResults" class="btn-secondary" disabled>æŸ¥çœ‹æ£€æµ‹ç»“æœ</button>
                            <button id="exportBrandCSV" class="btn-info" disabled>å¯¼å‡ºCSV</button>
                        </div>
                        
                        <div id="brandStatus" class="status">å°±ç»ª - è¯·è¾“å…¥å…³é”®è¯åå¼€å§‹æ£€æµ‹</div>
                    </div>
                </div>
                
                <!-- URLæ£€æµ‹ -->
                <div id="urlDetector" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">URLæ£€æµ‹</h2>
                        </div>
                        
                        <div class="form-group">
                            <label for="urls">è¾“å…¥Qoo10 URL:</label>
                            <textarea id="urls" rows="5" placeholder="è¯·è¾“å…¥Qoo10åº—é“ºURLæˆ–å•†å“URLï¼Œæ¯è¡Œä¸€ä¸ª&#10;ä¾‹å¦‚ï¼š&#10;https://www.qoo10.jp/shop/morecon?cit=1021126500&#10;https://www.qoo10.jp/g/1047384009"></textarea>
                        </div>
                        
                        <div class="button-group" style="display: flex; gap: 10px; margin-bottom: 20px;">
                            <button id="extractUrls" class="btn-primary">æå–å•†å“URL</button>
                            <button id="checkUrls" class="btn-info" disabled>æ£€æµ‹æ•°æ®</button>
                            <button id="exportUrlCSV" class="btn-info" disabled>å¯¼å‡ºCSV</button>
                        </div>
                        
                        <div id="urlStatus" class="status">å°±ç»ª - è¯·è¾“å…¥URLåå¼€å§‹æ£€æµ‹</div>
                    </div>
                </div>
                
                <!-- ç”¨æˆ·ç®¡ç† (ä»…ç®¡ç†å‘˜å¯è§) -->
                <div id="userManagement" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">ç”¨æˆ·ç®¡ç†</h2>
                            <button id="addUserBtn" class="btn-success">æ·»åŠ ç”¨æˆ·</button>
                        </div>
                        
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>ç”¨æˆ·å</th>
                                    <th>è§’è‰²</th>
                                    <th>æœ‰æ•ˆæœŸè‡³</th>
                                    <th>çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                <!-- ç”¨æˆ·æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€å¡«å…… -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ç³»ç»Ÿè®¾ç½® (ä»…ç®¡ç†å‘˜å¯è§) -->
                <div id="settings" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">ç³»ç»Ÿè®¾ç½®</h2>
                        </div>
                        
                        <div class="form-group">
                            <label for="adminPassword">ç®¡ç†å‘˜å¯†ç </label>
                            <input type="password" id="adminPassword" placeholder="è¯·è¾“å…¥æ–°å¯†ç ">
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmPassword">ç¡®è®¤å¯†ç </label>
                            <input type="password" id="confirmPassword" placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç ">
                        </div>
                        
                        <button id="changePasswordBtn" class="btn-primary">ä¿®æ”¹å¯†ç </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ·»åŠ ç”¨æˆ·æ¨¡æ€æ¡† -->
    <div id="addUserModal" class="modal hidden">
        <div class="card" style="width: 400px;">
            <div class="card-header">
                <h2 class="card-title">æ·»åŠ ç”¨æˆ·</h2>
                <button id="closeModalBtn" style="background: none; border: none; font-size: 20px; cursor: pointer;">Ã—</button>
            </div>
            
            <div class="form-group">
                <label for="newUsername">ç”¨æˆ·å</label>
                <input type="text" id="newUsername" placeholder="è¯·è¾“å…¥ç”¨æˆ·å">
            </div>
            
            <div class="form-group">
                <label for="newUserPassword">å¯†ç </label>
                <input type="password" id="newUserPassword" placeholder="è¯·è¾“å…¥å¯†ç ">
            </div>
            
            <div class="form-group">
                <label for="userRoleSelect">è§’è‰²</label>
                <select id="userRoleSelect">
                    <option value="user">æ™®é€šç”¨æˆ·</option>
                    <option value="admin">ç®¡ç†å‘˜</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="userExpiryDays">æœ‰æ•ˆæœŸï¼ˆå¤©ï¼‰</label>
                <input type="number" id="userExpiryDays" value="30" min="1">
            </div>
            
            <div class="button-group" style="display: flex; gap: 10px;">
                <button id="saveUserBtn" class="btn-success">ä¿å­˜</button>
                <button id="cancelUserBtn" class="btn-secondary">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // ç”¨æˆ·æ•°æ®å­˜å‚¨
        let users = JSON.parse(localStorage.getItem('qoo10_users')) || [
            { username: 'admin', password: '112211', role: 'admin', expiryDate: '2099-12-31' },
            { username: 'demo', password: '123456', role: 'user', expiryDate: '2024-12-31' }
        ];
        
        // å½“å‰ç™»å½•ç”¨æˆ·
        let currentUser = null;
        
        // DOMå…ƒç´ 
        const loginPage = document.getElementById('loginPage');
        const appPage = document.getElementById('appPage');
        const loginForm = document.getElementById('loginForm');
        const loginAlert = document.getElementById('loginAlert');
        const logoutBtn = document.getElementById('logoutBtn');
        const userRole = document.getElementById('userRole');
        const adminNav = document.getElementById('adminNav');
        const adminNav2 = document.getElementById('adminNav2');
        const expiryDate = document.getElementById('expiryDate');
        const remainingDays = document.getElementById('remainingDays');
        const userTableBody = document.getElementById('userTableBody');
        const addUserModal = document.getElementById('addUserModal');
        const addUserBtn = document.getElementById('addUserBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const saveUserBtn = document.getElementById('saveUserBtn');
        const cancelUserBtn = document.getElementById('cancelUserBtn');
        const changePasswordBtn = document.getElementById('changePasswordBtn');
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
            const savedUser = localStorage.getItem('qoo10_currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showAppPage();
            }
            
            // ç™»å½•è¡¨å•æäº¤
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                
                const user = users.find(u => u.username === username && u.password === password);
                
                if (user) {
                    // æ£€æŸ¥è´¦å·æ˜¯å¦è¿‡æœŸ
                    const today = new Date();
                    const expiry = new Date(user.expiryDate);
                    
                    if (expiry < today && user.role !== 'admin') {
                        showAlert('è´¦å·å·²è¿‡æœŸï¼Œè¯·è”ç³»ç®¡ç†å‘˜', 'error');
                        return;
                    }
                    
                    currentUser = user;
                    localStorage.setItem('qoo10_currentUser', JSON.stringify(user));
                    showAppPage();
                } else {
                    showAlert('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯', 'error');
                }
            });
            
            // é€€å‡ºç™»å½•
            logoutBtn.addEventListener('click', function() {
                currentUser = null;
                localStorage.removeItem('qoo10_currentUser');
                showLoginPage();
            });
            
            // å¯¼èˆªèœå•ç‚¹å‡»
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // ç§»é™¤æ‰€æœ‰activeç±»
                    document.querySelectorAll('.nav-link').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // æ·»åŠ activeç±»åˆ°å½“å‰ç‚¹å‡»çš„é“¾æ¥
                    this.classList.add('active');
                    
                    // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
                    document.querySelectorAll('.tab-content').forEach(tab => {
                        tab.classList.remove('active');
                    });
                    
                    // æ˜¾ç¤ºå¯¹åº”çš„æ ‡ç­¾å†…å®¹
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
            
            // å·¥å…·å¡ç‰‡ç‚¹å‡»
            document.querySelectorAll('.tool-card').forEach(card => {
                card.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // æ›´æ–°å¯¼èˆªèœå•
                    document.querySelectorAll('.nav-link').forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('data-tab') === tabId) {
                            item.classList.add('active');
                        }
                    });
                    
                    // æ˜¾ç¤ºå¯¹åº”çš„æ ‡ç­¾å†…å®¹
                    document.querySelectorAll('.tab-content').forEach(tab => {
                        tab.classList.remove('active');
                        if (tab.id === tabId) {
                            tab.classList.add('active');
                        }
                    });
                });
            });
            
            // ç”¨æˆ·ç®¡ç†ç›¸å…³
            addUserBtn.addEventListener('click', function() {
                addUserModal.classList.remove('hidden');
            });
            
            closeModalBtn.addEventListener('click', function() {
                addUserModal.classList.add('hidden');
            });
            
            cancelUserBtn.addEventListener('click', function() {
                addUserModal.classList.add('hidden');
            });
            
            saveUserBtn.addEventListener('click', function() {
                const newUsername = document.getElementById('newUsername').value;
                const newPassword = document.getElementById('newUserPassword').value;
                const role = document.getElementById('userRoleSelect').value;
                const expiryDays = parseInt(document.getElementById('userExpiryDays').value);
                
                if (!newUsername || !newPassword) {
                    alert('è¯·å¡«å†™å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯');
                    return;
                }
                
                // æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
                if (users.find(u => u.username === newUsername)) {
                    alert('ç”¨æˆ·åå·²å­˜åœ¨');
                    return;
                }
                
                // è®¡ç®—è¿‡æœŸæ—¥æœŸ
                const expiryDate = new Date();
                expiryDate.setDate(expiryDate.getDate() + expiryDays);
                
                // æ·»åŠ æ–°ç”¨æˆ·
                users.push({
                    username: newUsername,
                    password: newPassword,
                    role: role,
                    expiryDate: expiryDate.toISOString().split('T')[0]
                });
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('qoo10_users', JSON.stringify(users));
                
                // æ›´æ–°ç”¨æˆ·è¡¨æ ¼
                renderUserTable();
                
                // å…³é—­æ¨¡æ€æ¡†
                addUserModal.classList.add('hidden');
                
                // æ¸…ç©ºè¡¨å•
                document.getElementById('newUsername').value = '';
                document.getElementById('newUserPassword').value = '';
                document.getElementById('userRoleSelect').value = 'user';
                document.getElementById('userExpiryDays').value = '30';
            });
            
            // ä¿®æ”¹å¯†ç 
            changePasswordBtn.addEventListener('click', function() {
                const newPassword = document.getElementById('adminPassword').value;
                const confirmPassword = document.getElementById('confirmPassword').value;
                
                if (!newPassword || !confirmPassword) {
                    alert('è¯·å¡«å†™å¯†ç ');
                    return;
                }
                
                if (newPassword !== confirmPassword) {
                    alert('ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´');
                    return;
                }
                
                // æ›´æ–°ç®¡ç†å‘˜å¯†ç 
                const adminUser = users.find(u => u.username === 'admin');
                if (adminUser) {
                    adminUser.password = newPassword;
                    localStorage.setItem('qoo10_users', JSON.stringify(users));
                    alert('å¯†ç ä¿®æ”¹æˆåŠŸ');
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('adminPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                }
            });
            
            // åˆå§‹åŒ–ç”¨æˆ·è¡¨æ ¼
            renderUserTable();
        });
        
        // æ˜¾ç¤ºç™»å½•é¡µé¢
        function showLoginPage() {
            loginPage.classList.remove('hidden');
            appPage.classList.add('hidden');
        }
        
        // æ˜¾ç¤ºåº”ç”¨é¡µé¢
        function showAppPage() {
            loginPage.classList.add('hidden');
            appPage.classList.remove('hidden');
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
            userRole.textContent = `${currentUser.username} (${currentUser.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·'})`;
            
            // æ˜¾ç¤º/éšè—ç®¡ç†å‘˜èœå•
            if (currentUser.role === 'admin') {
                adminNav.classList.remove('hidden');
                adminNav2.classList.remove('hidden');
            } else {
                adminNav.classList.add('hidden');
                adminNav2.classList.add('hidden');
            }
            
            // æ›´æ–°æœ‰æ•ˆæœŸä¿¡æ¯
            const today = new Date();
            const expiry = new Date(currentUser.expiryDate);
            const diffTime = expiry - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            expiryDate.textContent = currentUser.expiryDate;
            remainingDays.textContent = diffDays > 0 ? diffDays : 0;
        }
        
        // æ˜¾ç¤ºæç¤ºä¿¡æ¯
        function showAlert(message, type) {
            loginAlert.textContent = message;
            loginAlert.className = `alert alert-${type}`;
            loginAlert.classList.remove('hidden');
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                loginAlert.classList.add('hidden');
            }, 3000);
        }
        
        // æ¸²æŸ“ç”¨æˆ·è¡¨æ ¼
        function renderUserTable() {
            userTableBody.innerHTML = '';
            
            users.forEach(user => {
                if (user.username === 'admin' && currentUser.username !== 'admin') return;
                
                const row = document.createElement('tr');
                
                // ç”¨æˆ·å
                const usernameCell = document.createElement('td');
                usernameCell.textContent = user.username;
                row.appendChild(usernameCell);
                
                // è§’è‰²
                const roleCell = document.createElement('td');
                roleCell.textContent = user.role === 'admin' ? 'ç®¡ç†å‘˜' : 'æ™®é€šç”¨æˆ·';
                row.appendChild(roleCell);
                
                // æœ‰æ•ˆæœŸ
                const expiryCell = document.createElement('td');
                expiryCell.textContent = user.expiryDate;
                row.appendChild(expiryCell);
                
                // çŠ¶æ€
                const statusCell = document.createElement('td');
                const statusSpan = document.createElement('span');
                
                const today = new Date();
                const expiry = new Date(user.expiryDate);
                
                if (expiry < today && user.role !== 'admin') {
                    statusSpan.textContent = 'å·²è¿‡æœŸ';
                    statusSpan.className = 'status status-danger';
                } else {
                    statusSpan.textContent = 'æœ‰æ•ˆ';
                    statusSpan.className = 'status status-success';
                }
                
                statusCell.appendChild(statusSpan);
                row.appendChild(statusCell);
                
                // æ“ä½œ
                const actionCell = document.createElement('td');
                
                if (user.username !== 'admin' || currentUser.username === 'admin') {
                    const editButton = document.createElement('button');
                    editButton.textContent = 'ç¼–è¾‘';
                    editButton.className = 'btn-info';
                    editButton.style.marginRight = '5px';
                    editButton.addEventListener('click', function() {
                        editUser(user.username);
                    });
                    
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'åˆ é™¤';
                    deleteButton.className = 'btn-danger';
                    deleteButton.addEventListener('click', function() {
                        deleteUser(user.username);
                    });
                    
                    actionCell.appendChild(editButton);
                    actionCell.appendChild(deleteButton);
                } else {
                    actionCell.textContent = '-';
                }
                
                row.appendChild(actionCell);
                userTableBody.appendChild(row);
            });
        }
        
        // ç¼–è¾‘ç”¨æˆ·
        function editUser(username) {
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            document.getElementById('newUsername').value = user.username;
            document.getElementById('newUserPassword').value = user.password;
            document.getElementById('userRoleSelect').value = user.role;
            
            // è®¡ç®—å‰©ä½™å¤©æ•°
            const today = new Date();
            const expiry = new Date(user.expiryDate);
            const diffTime = expiry - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            document.getElementById('userExpiryDays').value = diffDays > 0 ? diffDays : 0;
            
            addUserModal.classList.remove('hidden');
            
            // ä¿®æ”¹ä¿å­˜æŒ‰é’®è¡Œä¸º
            saveUserBtn.onclick = function() {
                const newUsername = document.getElementById('newUsername').value;
                const newPassword = document.getElementById('newUserPassword').value;
                const role = document.getElementById('userRoleSelect').value;
                const expiryDays = parseInt(document.getElementById('userExpiryDays').value);
                
                if (!newUsername || !newPassword) {
                    alert('è¯·å¡«å†™å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯');
                    return;
                }
                
                // æ›´æ–°ç”¨æˆ·ä¿¡æ¯
                user.username = newUsername;
                user.password = newPassword;
                user.role = role;
                
                // è®¡ç®—æ–°çš„è¿‡æœŸæ—¥æœŸ
                const newExpiryDate = new Date();
                newExpiryDate.setDate(newExpiryDate.getDate() + expiryDays);
                user.expiryDate = newExpiryDate.toISOString().split('T')[0];
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('qoo10_users', JSON.stringify(users));
                
                // æ›´æ–°ç”¨æˆ·è¡¨æ ¼
                renderUserTable();
                
                // å…³é—­æ¨¡æ€æ¡†
                addUserModal.classList.add('hidden');
                
                // é‡ç½®ä¿å­˜æŒ‰é’®è¡Œä¸º
                saveUserBtn.onclick = function() {
                    // æ·»åŠ ç”¨æˆ·çš„é€»è¾‘
                };
                
                // æ¸…ç©ºè¡¨å•
                document.getElementById('newUsername').value = '';
                document.getElementById('newUserPassword').value = '';
                document.getElementById('userRoleSelect').value = 'user';
                document.getElementById('userExpiryDays').value = '30';
            };
        }
        
        // åˆ é™¤ç”¨æˆ·
        function deleteUser(username) {
            if (username === 'admin') {
                alert('ä¸èƒ½åˆ é™¤ç®¡ç†å‘˜è´¦å·');
                return;
            }
            
            if (confirm(`ç¡®å®šè¦åˆ é™¤ç”¨æˆ· "${username}" å—ï¼Ÿ`)) {
                users = users.filter(u => u.username !== username);
                localStorage.setItem('qoo10_users', JSON.stringify(users));
                renderUserTable();
            }
        }
        
        // ä»¥ä¸‹æ˜¯åŸæœ‰åŠŸèƒ½çš„ç®€åŒ–å®ç°
        // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™äº›åŠŸèƒ½éœ€è¦ä¸åç«¯APIäº¤äº’
        
        // å…³é”®è¯é‡‡é›†åŠŸèƒ½
        document.getElementById('startCollect').addEventListener('click', function() {
            const keywords = document.getElementById('collectorKeywords').value.split('\n')
                .map(k => k.trim())
                .filter(k => k.length > 0);
            
            if (keywords.length === 0) {
                document.getElementById('collectorStatus').textContent = 'è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå…³é”®è¯';
                document.getElementById('collectorStatus').className = 'status status-danger';
                return;
            }
            
            // æ¨¡æ‹Ÿé‡‡é›†è¿‡ç¨‹
            document.getElementById('startCollect').disabled = true;
            document.getElementById('stopCollect').disabled = false;
            document.getElementById('collectorStatus').textContent = 'å¼€å§‹æ‰¹é‡é‡‡é›†...';
            document.getElementById('collectorStatus').className = 'status status-warning';
            
            let current = 0;
            const total = keywords.length;
            
            const interval = setInterval(() => {
                current++;
                document.getElementById('progressText').textContent = `${current}/${total}`;
                document.getElementById('progressFill').style.width = `${(current / total) * 100}%`;
                
                if (current >= total) {
                    clearInterval(interval);
                    document.getElementById('startCollect').disabled = false;
                    document.getElementById('stopCollect').disabled = true;
                    document.getElementById('exportCSV').disabled = false;
                    document.getElementById('collectorStatus').textContent = 'é‡‡é›†å®Œæˆ';
                    document.getElementById('collectorStatus').className = 'status status-success';
                }
            }, 500);
            
            // åœæ­¢æŒ‰é’®åŠŸèƒ½
            document.getElementById('stopCollect').onclick = function() {
                clearInterval(interval);
                document.getElementById('startCollect').disabled = false;
                document.getElementById('stopCollect').disabled = true;
                document.getElementById('collectorStatus').textContent = 'é‡‡é›†å·²åœæ­¢';
                document.getElementById('collectorStatus').className = 'status status-danger';
            };
        });
        
        // å“ç‰Œæ£€æµ‹åŠŸèƒ½
        document.getElementById('checkBrand').addEventListener('click', function() {
            const keywords = document.getElementById('brandKeywords').value.split('\n')
                .map(k => k.trim())
                .filter(k => k.length > 0);
            
            if (keywords.length === 0) {
                document.getElementById('brandStatus').textContent = 'è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªå…³é”®è¯';
                document.getElementById('brandStatus').className = 'status status-danger';
                return;
            }
            
            document.getElementById('brandStatus').textContent = 'æ­£åœ¨æ£€æµ‹å“ç‰Œ...';
            document.getElementById('brandStatus').className = 'status status-warning';
            
            // æ¨¡æ‹Ÿæ£€æµ‹è¿‡ç¨‹
            setTimeout(() => {
                document.getElementById('viewBrandResults').disabled = false;
                document.getElementById('exportBrandCSV').disabled = false;
                document.getElementById('brandStatus').textContent = 'å“ç‰Œæ£€æµ‹å®Œæˆ';
                document.getElementById('brandStatus').className = 'status status-success';
            }, 2000);
        });
        
        // URLæ£€æµ‹åŠŸèƒ½
        document.getElementById('extractUrls').addEventListener('click', function() {
            const urls = document.getElementById('urls').value.split('\n')
                .map(u => u.trim())
                .filter(u => u.length > 0);
            
            if (urls.length === 0) {
                document.getElementById('urlStatus').textContent = 'è¯·è¾“å…¥è‡³å°‘ä¸€ä¸ªURL';
                document.getElementById('urlStatus').className = 'status status-danger';
                return;
            }
            
            document.getElementById('urlStatus').textContent = 'æ­£åœ¨æå–å•†å“URL...';
            document.getElementById('urlStatus').className = 'status status-warning';
            
            // æ¨¡æ‹Ÿæå–è¿‡ç¨‹
            setTimeout(() => {
                document.getElementById('checkUrls').disabled = false;
                document.getElementById('urlStatus').textContent = 'URLæå–å®Œæˆ';
                document.getElementById('urlStatus').className = 'status status-success';
            }, 2000);
        });
        
        document.getElementById('checkUrls').addEventListener('click', function() {
            document.getElementById('urlStatus').textContent = 'æ­£åœ¨æ£€æµ‹URLæ•°æ®...';
            document.getElementById('urlStatus').className = 'status status-warning';
            
            // æ¨¡æ‹Ÿæ£€æµ‹è¿‡ç¨‹
            setTimeout(() => {
                document.getElementById('exportUrlCSV').disabled = false;
                document.getElementById('urlStatus').textContent = 'URLæ£€æµ‹å®Œæˆ';
                document.getElementById('urlStatus').className = 'status status-success';
            }, 2000);
        });
    </script>
</body>
</html>
